"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),r=require("@react-three/fiber"),t=require("three"),n=require("./OrthographicCamera.cjs.js"),u=require("./useCamera.cjs.js");function o(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}require("@babel/runtime/helpers/extends"),require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),require("react-merge-refs");var a=o(e),i=a.createContext({}),c=2*Math.PI,s=new t.Object3D,l=new t.Matrix4,f=new t.Quaternion,p=new t.Quaternion,d=new t.Vector3,h=new t.Vector3;exports.GizmoHelper=function(e){var o=e.alignment,m=void 0===o?"bottom-right":o,g=e.margin,b=void 0===g?[80,80]:g,v=e.renderPriority,y=void 0===v?1:v,w=e.onUpdate,j=e.onTarget,q=e.children,x=r.useThree((function(e){return e.size})),O=r.useThree((function(e){return e.camera})),T=r.useThree((function(e){return e.controls})),C=r.useThree((function(e){return e.gl})),k=r.useThree((function(e){return e.scene})),P=r.useThree((function(e){return e.invalidate})),R=a.useRef(),z=a.useRef(),E=a.useRef(null),M=a.useState((function(){return new t.Scene}))[0],D=a.useRef(!1),Q=a.useRef(0),S=a.useRef(new t.Vector3(0,0,0));a.useEffect((function(){return k.background&&(R.current=k.background,k.background=null,M.background=R.current),function(){R.current&&(k.background=R.current)}}),[]);r.useFrame((function(e,r){var t;E.current&&z.current&&(!function(e){if(D.current)if(f.angleTo(p)<.01)D.current=!1;else{var r=e*c;f.rotateTowards(p,r),O.position.set(0,0,1).applyQuaternion(f).multiplyScalar(Q.current).add(S.current),O.up.set(0,1,0).applyQuaternion(f).normalize(),O.quaternion.copy(f),w?w():T&&T.update(),P()}}(r),l.copy(O.matrix).invert(),null==(t=z.current)||t.quaternion.setFromRotationMatrix(l),C.autoClear=!1,C.clearDepth(),C.render(M,E.current))}),y);var _={tweenCamera:function(e){D.current=!0,(T||j)&&(S.current=(null==T?void 0:T.target)||(null==j?void 0:j())),Q.current=O.position.distanceTo(d),f.copy(O.quaternion),h.copy(e).multiplyScalar(Q.current).add(d),s.lookAt(h),p.copy(s.quaternion),P()},raycast:u.useCamera(E)},V=b[0],W=b[1],F=m.endsWith("-left")?-x.width/2+V:x.width/2-V,G=m.startsWith("top-")?x.height/2-W:-x.height/2+W;return r.createPortal(a.createElement(i.Provider,{value:_},a.createElement(n.OrthographicCamera,{ref:E,makeDefault:!1,position:[0,0,200]}),a.createElement("group",{ref:z,position:[F,G,0]},q)),M)},exports.useGizmoContext=function(){return a.useContext(i)};
