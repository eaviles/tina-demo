"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("@babel/runtime/helpers/extends"),r=require("@babel/runtime/helpers/objectWithoutPropertiesLoose"),t=require("react"),a=require("three"),n=require("@react-three/fiber"),u=require("three-stdlib");function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function o(e){if(e&&e.__esModule)return e;var r=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var a=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(r,t,a.get?a:{enumerable:!0,get:function(){return e[t]}})}})),r.default=e,Object.freeze(r)}var l=i(e),d=i(r),f=o(t),s=o(a),c=f.forwardRef((function(e,r){var t=e.frames,a=void 0===t?1/0:t,i=e.opacity,o=void 0===i?1:i,c=e.width,h=void 0===c?1:c,m=e.height,p=void 0===m?1:m,g=e.blur,v=void 0===g?1:g,b=e.far,M=void 0===b?10:b,w=e.resolution,y=void 0===w?256:w,T=d.default(e,["frames","opacity","width","height","blur","far","resolution"]),j=n.useThree((function(e){return e.scene})),x=n.useThree((function(e){return e.gl})),R=f.useRef(),O=f.useMemo((function(){var e=new s.WebGLRenderTarget(y,y),r=new s.WebGLRenderTarget(y,y);r.texture.generateMipmaps=e.texture.generateMipmaps=!1;var t=new s.PlaneBufferGeometry(h,p).rotateX(Math.PI/2),a=new s.Mesh(t),n=new s.MeshDepthMaterial;n.depthTest=n.depthWrite=!1,n.onBeforeCompile=function(e){return e.fragmentShader=e.fragmentShader.replace("1.0 - fragCoordZ ), opacity );","0.0 ), ( 1.0 - fragCoordZ ) * 1.0 );")};var i=new s.ShaderMaterial(u.HorizontalBlurShader),o=new s.ShaderMaterial(u.VerticalBlurShader);return o.depthTest=i.depthTest=!1,[e,t,n,a,i,o,r]}),[y,h,p]),P=O[0],S=O[1],q=O[2],B=O[3],C=O[4],E=O[5],k=O[6],D=0;return n.useFrame((function(){if(R.current&&(a===1/0||D<a)){var e=j.background;j.background=null,j.overrideMaterial=q,x.setRenderTarget(P),x.render(j,R.current),j.overrideMaterial=null,B.material=C,B.material.uniforms.tDiffuse.value=P.texture,C.uniforms.h.value=v/256,x.setRenderTarget(k),x.render(B,R.current),B.material=E,B.material.uniforms.tDiffuse.value=k.texture,E.uniforms.v.value=v/256,x.setRenderTarget(P),x.render(B,R.current),x.setRenderTarget(null),j.background=e,D++}})),f.createElement("group",l.default({},T,{ref:r}),f.createElement("mesh",{geometry:S,scale:[1,-1,1],rotation:[-Math.PI/2,0,0]},f.createElement("meshBasicMaterial",{map:P.texture,transparent:!0,opacity:o})),f.createElement("orthographicCamera",{ref:R,args:[-h/2,h/2,p/2,-p/2,0,M]}))}));exports.ContactShadows=c;
